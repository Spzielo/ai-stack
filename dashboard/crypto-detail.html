<!DOCTYPE html>
<html lang="fr">

<head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>Crypto Detail</title>
      <link rel="preconnect" href="https://fonts.googleapis.com">
      <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;500;700&display=swap" rel="stylesheet">
      <link rel="stylesheet" href="style.css">
      <style>
            body {
                  align-items: flex-start !important;
                  overflow-y: auto !important;
                  padding: 2rem 0;
            }

            .container {
                  width: 100%;
                  max-width: 1200px;
                  margin: 0 auto;
                  padding: 0 2rem;
            }

            .back-btn {
                  display: inline-block;
                  color: rgba(255, 255, 255, 0.6);
                  text-decoration: none;
                  margin-bottom: 2rem;
                  transition: color 0.3s ease;
            }

            .back-btn:hover {
                  color: white;
            }

            .detail-header {
                  background: rgba(255, 255, 255, 0.05);
                  border: 1px solid rgba(255, 255, 255, 0.1);
                  border-radius: 16px;
                  padding: 2rem;
                  margin-bottom: 2rem;
            }

            .detail-title {
                  font-size: 2.5rem;
                  font-weight: 700;
                  margin-bottom: 0.5rem;
            }

            .detail-subtitle {
                  color: rgba(255, 255, 255, 0.6);
                  font-size: 1.2rem;
            }

            .metrics-grid {
                  display: grid;
                  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
                  gap: 1.5rem;
                  margin-bottom: 2rem;
            }

            .metric-card {
                  background: rgba(255, 255, 255, 0.05);
                  border: 1px solid rgba(255, 255, 255, 0.1);
                  border-radius: 12px;
                  padding: 1.5rem;
            }

            .metric-label {
                  font-size: 14px;
                  color: rgba(255, 255, 255, 0.6);
                  margin-bottom: 8px;
            }

            .metric-value {
                  font-size: 24px;
                  font-weight: 700;
                  color: white;
            }

            .loading {
                  text-align: center;
                  padding: 40px;
                  color: rgba(255, 255, 255, 0.6);
            }

            .spinner {
                  border: 3px solid rgba(255, 255, 255, 0.1);
                  border-top: 3px solid #667eea;
                  border-radius: 50%;
                  width: 40px;
                  height: 40px;
                  animation: spin 1s linear infinite;
                  margin: 0 auto 16px;
            }

            @keyframes spin {
                  0% {
                        transform: rotate(0deg);
                  }

                  100% {
                        transform: rotate(360deg);
                  }
            }
      </style>
</head>

<body>
      <div class="background-orb"></div>
      <div class="background-orb two"></div>

      <div class="container">
            <a href="crypto.html" class="back-btn">‚Üê Retour au dashboard</a>

            <div id="content">
                  <div class="loading">
                        <div class="spinner"></div>
                        <p>Chargement des d√©tails...</p>
                  </div>
            </div>
      </div>

      <script>
            const API_BASE = 'http://localhost:8000';

            // Get symbol from URL
            const urlParams = new URLSearchParams(window.location.search);
            const symbol = urlParams.get('symbol');

            if (!symbol) {
                  document.getElementById('content').innerHTML = `
                <div class="loading">
                    <p style="color: #ef4444;">‚ùå Aucun symbole sp√©cifi√©</p>
                </div>
            `;
            } else {
                  loadCryptoDetail(symbol);
            }

            async function loadCryptoDetail(symbol) {
                  try {
                        const response = await fetch(`${API_BASE}/crypto/assets/${symbol}`);

                        if (!response.ok) {
                              throw new Error(`Erreur ${response.status}`);
                        }

                        const data = await response.json();
                        renderDetail(data);
                  } catch (error) {
                        document.getElementById('content').innerHTML = `
                    <div class="loading">
                        <p style="color: #ef4444;">‚ùå Erreur de chargement</p>
                        <p style="font-size: 14px; color: rgba(255,255,255,0.6);">${error.message}</p>
                    </div>
                `;
                  }
            }

            function renderDetail(crypto) {
                  const statusClass = crypto.status ? `status-${crypto.status.toLowerCase()}` : 'status-observer';
                  const price = crypto.price_usd ? `$${crypto.price_usd.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}` : 'N/A';
                  const marketCap = crypto.market_cap ? `$${(crypto.market_cap / 1e9).toFixed(2)}B` : 'N/A';
                  const tvl = crypto.tvl ? `$${(crypto.tvl / 1e9).toFixed(2)}B` : 'N/A';

                  document.getElementById('content').innerHTML = `
                <div class="detail-header">
                    <div class="detail-title">${crypto.symbol}</div>
                    <div class="detail-subtitle">${crypto.name} ‚Ä¢ ${crypto.category || 'N/A'}</div>
                </div>

                <div class="metrics-grid">
                    <div class="metric-card">
                        <div class="metric-label">Prix</div>
                        <div class="metric-value">${price}</div>
                    </div>
                    
                    <div class="metric-card">
                        <div class="metric-label">Market Cap</div>
                        <div class="metric-value">${marketCap}</div>
                    </div>
                    
                    <div class="metric-card">
                        <div class="metric-label">TVL</div>
                        <div class="metric-value">${tvl}</div>
                    </div>
                    
                    <div class="metric-card">
                        <div class="metric-label">Score Total</div>
                        <div class="metric-value">${crypto.total_score ? crypto.total_score.toFixed(1) : '-'}/30</div>
                    </div>
                    
                    <div class="metric-card">
                        <div class="metric-label">Fundamentals</div>
                        <div class="metric-value">${crypto.fundamentals_score ? crypto.fundamentals_score.toFixed(1) : '-'}/10</div>
                    </div>
                    
                    <div class="metric-card">
                        <div class="metric-label">Tokenomics</div>
                        <div class="metric-value">${crypto.tokenomics_score ? crypto.tokenomics_score.toFixed(1) : '-'}/10</div>
                    </div>
                    
                    <div class="metric-card">
                        <div class="metric-label">Momentum</div>
                        <div class="metric-value">${crypto.momentum_score ? crypto.momentum_score.toFixed(1) : '-'}/10</div>
                    </div>
                    
                    <div class="metric-card">
                        <div class="metric-label">Statut</div>
                        <div class="metric-value">
                            <span class="status-badge ${statusClass}">${crypto.status || 'N/A'}</span>
                        </div>
                    </div>
                </div>

                ${crypto.thesis ? `
                    <div class="metric-card" style="margin-bottom: 1.5rem;">
                        <div class="metric-label">Th√®se d'investissement</div>
                        <p style="color: rgba(255,255,255,0.8); margin-top: 1rem; line-height: 1.6;">${crypto.thesis}</p>
                    </div>
                ` : ''}

                ${crypto.risks ? `
                    <div class="metric-card" style="margin-bottom: 1.5rem;">
                        <div class="metric-label">Risques</div>
                        <p style="color: rgba(255,255,255,0.8); margin-top: 1rem; line-height: 1.6;">${crypto.risks}</p>
                    </div>
                ` : ''}

                <div style="text-align: center; margin-top: 3rem; color: rgba(255,255,255,0.4);">
                    <p>üìä Plus de d√©tails √† venir (graphiques, √©v√©nements, etc.)</p>
                </div>
            `;
            }
      </script>
</body>

</html>